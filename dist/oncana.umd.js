(function(a,y){typeof exports=="object"&&typeof module!="undefined"?y(exports):typeof define=="function"&&define.amd?define(["exports"],y):(a=typeof globalThis!="undefined"?globalThis:a||self,y(a.oncana={}))})(this,function(a){"use strict";const y=document.querySelector("#user-form"),E=document.querySelector("#pro-form"),b=document.querySelector(".loader"),w=document.querySelector(".error-msg"),v=document.querySelector(".success-msg"),O=document.getElementById("select-cancer-type"),_=document.getElementById("select-cancer-stage"),P=document.getElementById("select-treatment-type"),A=document.getElementById("select-treatment-stage"),M=document.getElementById("select-eat"),D=document.getElementById("select-move"),S=document.getElementById("select-job"),Ee=document.getElementById("gender"),I=document.getElementById("checkboxes-side-effects"),L=document.getElementById("checkboxes-lives"),B=document.getElementById("checkboxes-lifestyles"),we=document.getElementById("checkboxes-categories"),ve=document.getElementById("image-input"),q=document.getElementById("image-preview"),Be=document.getElementById("image-upload"),xe=document.getElementById("image-feedback"),z=document.getElementById("first-name"),W=document.getElementById("bio"),$=document.getElementById("last-name"),R=document.getElementById("phone"),J=document.getElementById("email"),ke=document.getElementById("address"),H=document.getElementById("website"),K=document.getElementById("job-title"),Ce=document.getElementById("oncana-categories");var Se=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",userForm:y,proForm:E,loader:b,errorMsg:w,successMsg:v,cancerType:O,cancerStage:_,treatmentType:P,treatmentStage:A,eat:M,move:D,job:S,gender:Ee,sideEffectWrapper:I,liveWrapper:L,lifestyleWrapper:B,categoryWrapper:we,imageInput:ve,imagePreview:q,imageUpload:Be,imageFeedback:xe,firstName:z,bio:W,lastName:$,phone:R,email:J,address:ke,website:H,jobTitle:K,oncanaCategories:Ce});const V=document.getElementsByClassName("cancer-type-item"),G=document.getElementsByClassName("cancer-stage-item"),Q=document.getElementsByClassName("treatment-type-item"),X=document.getElementsByClassName("treatment-stage-item"),j=document.getElementsByClassName("side-effect-item"),Y=document.getElementsByClassName("category-item"),Z=document.getElementsByClassName("lifestyle-item"),ee=document.getElementsByClassName("job-item"),F=document.getElementsByClassName("collection-page-item"),te=()=>{var o,n,s,c,r,i,d,m,l,g,T,be,he,Te;const e=Array.from(F[0].children),t=e[13];return{firstName:((o=e[0])==null?void 0:o.innerText)||"",lastName:((n=e[1])==null?void 0:n.innerText)||"",bio:((s=e[2])==null?void 0:s.innerText)||"",phone:((c=e[3])==null?void 0:c.innerText)||"",postCode:((r=e[4])==null?void 0:r.innerText)||"",street:((i=e[5])==null?void 0:i.innerText)||"",website:((d=e[6])==null?void 0:d.innerText)||"",itemId:((m=e[7])==null?void 0:m.innerText)||"","selected-lifestyles":((l=e[8])==null?void 0:l.innerText)||"","selected-categories":((g=e[9])==null?void 0:g.innerText)||"",jobTitle:((T=e[10])==null?void 0:T.innerText)||"",job:((be=e[11])==null?void 0:be.innerText)||"","selected-side-effects":((he=e[12])==null?void 0:he.innerText)||"",image:(t==null?void 0:t.src)||"",email:((Te=e[14])==null?void 0:Te.innerText)||""}},Ie=()=>{var t;return{firstName:((t=Array.from(F[0].children)[0])==null?void 0:t.innerText)||""}};var je=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",cancerType:V,cancerStage:G,treatmentType:Q,treatmentStage:X,sideEffect:j,category:Y,lifestyle:Z,job:ee,cpItem:F,getCurrentPro:te,getCurrentUser:Ie});const x="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",Fe=x+"/webflow/user",Ne=x+"/webflow/pro",Ue=x+"/get-presigned-url",oe={"Content-Type":"application/json",Accept:"*"},ne=(e,t)=>fetch(Ue,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),se=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),ce=e=>fetch(Fe,{method:"PATCH",headers:oe,body:JSON.stringify(e)}),ae=e=>fetch(Ne,{method:"PATCH",headers:oe,body:JSON.stringify(e)});var Oe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:x,getUploadUrl:ne,uploadToS3:se,updateUser:ce,updatePro:ae});const re=e=>{if(de(),ue(),b.style.display="flex",e){const t=b.getElementsByTagName("div")[0];t.innerText=e}},le=()=>{b.style.display="none",b.innerText=""},ie=(e,t)=>{console.log(e,t),w.style.display="flex",w.innerText=e,setTimeout(()=>{de()},3e3)},de=()=>{w.style.display="none"},me=e=>{if(v.style.display="flex",e){const t=v.getElementsByTagName("div")[0];t.innerText=e}setTimeout(()=>{ue()},3e3)},ue=()=>{v.style.display="none"},_e=()=>{const e=document.getElementsByTagName("button");for(let t of Array.from(e))t.disabled=!0},Pe=()=>{const e=document.getElementsByTagName("button");for(let t of Array.from(e))t.disabled=!1},k=(e,t,o)=>{e&&t&&o&&e.options.add(new Option(o,t))},N=(e,t,o)=>{const n=document.createElement("label"),s=document.createElement("input");s.type="checkbox",s.name=e,s.setAttribute("data-type",o);const c=document.createElement("span");c.className="checkmark";const r=document.createElement("span");return r.className="checktext",r.innerText=t,n.appendChild(s),n.appendChild(c),n.appendChild(r),n},f=(e,t)=>{Object.values(e).map(o=>{const n=o.children[0].innerText,s=o.children[1].innerText;k(t,s,n)})},C=(e,t,o)=>{Object.values(e).map(n=>{const s=n.children[0].innerText,c=n.children[1].innerText,r=N(c,s,o);t.appendChild(r)})},p=(e,t)=>{e.defaultValue=t,e.placeholder=t},U=(e,t)=>{Array.from(e.getElementsByTagName("input")).forEach(n=>{t.includes(n.name)&&(n.checked=!0)})},pe=(e,t)=>{const o=Array.from(e.options).map(n=>n.value).indexOf(t);o&&(e.options.selectedIndex=o)};var Ae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:k,addCheckBox:N,mapCollectionSelector:f,mapCollectionCheckBox:C,setDefaultInput:p,setDefaultCheckboxes:U,setDefaultOption:pe});const Me=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),ge=async e=>{const[t,o]=await Promise.all([Me(e),ne(e.name,e.type)]);if(!o.ok)throw new Error("Could not get url upload");const{uploadUrl:n}=await o.json(),s=await se(n,t);if(!s.ok)throw new Error("Could not upload the image");return s.url},De=["image/jpeg","image/png","image/jpg"],Le=e=>De.includes(e.type)?e.size>5*10**6?"File is too big.":"ok":"File type is invalid",qe=(e,t,o)=>{e.addEventListener("change",n=>{const s=n.target.files[0],c=Le(s);c==="ok"?(console.log("File",n.target.files[0]),t.src=URL.createObjectURL(n.target.files[0])):o.innerText=c}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var ze=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:ge,previewImage:qe});const We=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),u=e=>e&&e[e.selectedIndex].value,$e=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),h=(e,t)=>Array.from(e).filter(o=>o.checked&&(t?o.getAttribute("data-type")===t:1)).map(o=>o.name).filter(o=>o);var Re=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:We,uniSelect:u,multiCheckbox:$e,multiCheckboxFromEl:h});const ye=()=>{var n,s,c,r,i,d,m,l,g,T;const e=y.elements,t=y.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((s=e["last-name"])==null?void 0:s.value)||"",gender:u(e.gender.options)||"",dob:((c=e.dob)==null?void 0:c.value)||"",postcode:((r=e.postcode)==null?void 0:r.value)||"","cancer-type":u((i=e["cancer-type"])==null?void 0:i.options)||"","cancer-stage":u((d=e["cancer-stage"])==null?void 0:d.options)||"","treatment-type":u((m=e["treatment-type"])==null?void 0:m.options)||"","treatment-stage":u((l=e["treatment-stage"])==null?void 0:l.options)||"","side-effects":h(t,"side-effect"),eat:u((g=e.eat)==null?void 0:g.options)||"",move:u((T=e.move)==null?void 0:T.options)||"",live:h(t,"live")}},fe=()=>{var n,s,c,r,i,d,m,l;const e=E.elements,t=E.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((s=e["last-name"])==null?void 0:s.value)||"",bio:((c=e.bio)==null?void 0:c.value)||"",job:u((r=e.job)==null?void 0:r.options)||"","job-title":((i=e.job)==null?void 0:i.value)||"",address:((d=e.address)==null?void 0:d.value)||"",phone:((m=e.phone)==null?void 0:m.value)||"",website:((l=e.website)==null?void 0:l.value)||"","side-effects":h(t,"side-effect"),lifestyles:h(t,"lifestyle")}},Je=()=>{C(Z,B,"lifestyle"),console.log("Create"),C(j,I,"side-effect"),f(ee,S)},He=()=>{f(Q,P),f(X,A),f(V,O),f(G,_),C(j,I,"side-effect"),Object.values(Y).map(e=>{const t=e.children[0].innerText,o=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":k(M,o,t);break;case"Move":k(D,o,t);break;case"Live":const s=N(o,t,"live");L.appendChild(s);break}})},Ke=async e=>{e.preventDefault(),re();try{const t=ye();let o="620f78370eeeb2cc10a23e94";t["webflow-id"]=o;const n=await ce(t);if(!n.ok)throw new Error("Network response was not OK");me("Success");const s=await n.json();window.location.replace(window.location.href+"/user/"+s.result.slug)}catch(t){ie("Could not update your information",t)}finally{le()}},Ve=async(e,t,o,n=!1)=>{var s;e.preventDefault(),re(),_e();try{const c=fe();c["memberstack-id"]=t,c["webflow-id"]=o,console.log("MMM",t);const r=E.elements;let i="";if(((s=r.picture)==null?void 0:s.files)&&r.picture.files[0])try{const l=r.picture.files[0],g=await ge(l);console.log("Image Url",g),c.image=g}catch(l){i="Could not upload your image",console.log(i,l)}const d=await ae(c);if(!d.ok)throw new Error("Network response was not OK");me();const m=await d.json();n&&window.location.replace(window.location.href+"/health-professional/"+m.result.slug)}catch(c){ie("Could not update your information",c)}finally{le(),Pe()}},Ge=()=>{const e=te();p(z,e.firstName),p($,e.lastName),p(W,e.bio),p(R,e.phone),p(J,e.email),p(H,e.website),p(K,e.jobTitle),pe(S,e.job),U(B,e["selected-lifestyles"].split(",")),U(B,e["selected-side-effects"].split(",")),q.src=e.image};a.api=Oe,a.cf=Ae,a.collection=je,a.createProFormFields=Je,a.createUserFormFields=He,a.gf=Re,a.mapProFieldToBody=fe,a.mapUserFieldToBody=ye,a.populateProFormDefaults=Ge,a.selector=Se,a.submitProForm=Ve,a.submitUserForm=Ke,a.upload=ze,Object.defineProperty(a,"__esModule",{value:!0}),a[Symbol.toStringTag]="Module"});
