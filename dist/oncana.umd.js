(function(s,m){typeof exports=="object"&&typeof module!="undefined"?m(exports):typeof define=="function"&&define.amd?define(["exports"],m):(s=typeof globalThis!="undefined"?globalThis:s||self,m(s.oncana={}))})(this,function(s){"use strict";const m=document.querySelector("#user-form"),w=document.querySelector("#pro-form"),y=document.querySelector(".loader"),g=document.querySelector(".error-msg"),f=document.querySelector(".success-msg"),j=document.getElementById("select-cancer-type"),F=document.getElementById("select-cancer-stage"),U=document.getElementById("select-treatment-type"),_=document.getElementById("select-treatment-stage"),O=document.getElementById("select-eat"),N=document.getElementById("select-move"),P=document.getElementById("select-job"),k=document.getElementById("checkboxes-side-effects"),M=document.getElementById("checkboxes-lives"),S=document.getElementById("checkboxes-lifestyles"),de=document.getElementById("checkboxes-categories"),me=document.getElementById("image-input"),ue=document.getElementById("image-preview"),pe=document.getElementById("image-upload"),ye=document.getElementById("image-feedback"),A=document.getElementById("first-name"),ge=document.getElementById("bio"),fe=document.getElementById("last-name"),be=document.getElementById("phone"),he=document.getElementById("job-title"),we=document.getElementById("oncana-categories");var Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",userForm:m,proForm:w,loader:y,errorMsg:g,successMsg:f,cancerType:j,cancerStage:F,treatmentType:U,treatmentStage:_,eat:O,move:N,job:P,sideEffectWrapper:k,live:M,lifestyleWrapper:S,categoryWrapper:de,imageInput:me,imagePreview:ue,imageUpload:pe,imageFeedback:ye,firstName:A,bio:ge,lastName:fe,phone:be,jobTitle:he,oncanaCategories:we});const L=document.getElementsByClassName("cancer-type-item"),D=document.getElementsByClassName("cancer-stage-item"),q=document.getElementsByClassName("treatment-type-item"),z=document.getElementsByClassName("treatment-stage-item"),B=document.getElementsByClassName("side-effect-item"),W=document.getElementsByClassName("category-item"),$=document.getElementsByClassName("lifestyle-item"),R=document.getElementsByClassName("job-item"),J=document.getElementsByClassName("collection-page-item"),I=Array.from(J[0].children),x={firstName:I[0].innerText,lifestyles:I[3].innerText},Ee={firstName:I[0].innerText};var ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",cancerType:L,cancerStage:D,treatmentType:q,treatmentStage:z,sideEffect:B,category:W,lifestyle:$,job:R,cpItem:J,pro:x,user:Ee});const T="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",ke=T+"/webflow/user",Se=T+"/webflow/pro",Be=T+"/get-presigned-url",H={"Content-Type":"application/json",Accept:"*"},K=(e,t)=>fetch(Be,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),V=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),G=e=>fetch(ke,{method:"PATCH",headers:H,body:JSON.stringify(e)}),Q=e=>fetch(Se,{method:"PATCH",headers:H,body:JSON.stringify(e)});var Ie=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:T,getUploadUrl:K,uploadToS3:V,updateUser:G,updatePro:Q});const X=()=>{ee(),oe(),y.style.display="flex",y.innerText="Loading"},Y=()=>{y.style.display="none",y.innerText=""},Z=(e,t)=>{console.log(e,t),g.style.display="flex",g.innerText=e,setTimeout(()=>{ee()},3e3)},ee=()=>{g.style.display="none",g.innerText=""},te=e=>{f.style.display="flex",f.innerText=e,setTimeout(()=>{oe()},3e3)},oe=()=>{f.style.display="none",f.innerText=""},E=(e,t,o)=>{e&&t&&o&&e.options.add(new Option(o,t))},C=(e,t,o)=>{const n=document.createElement("label"),c=document.createElement("input");c.type="checkbox",c.name=e,c.setAttribute("data-type",o);const a=document.createElement("span");a.className="checkmark";const l=document.createElement("span");return l.className="checktext",l.innerText=t,n.appendChild(c),n.appendChild(a),n.appendChild(l),n},p=(e,t)=>{Object.values(e).map(o=>{const n=o.children[0].innerText,c=o.children[1].innerText;E(t,c,n)})},v=(e,t,o)=>{Object.values(e).map(n=>{const c=n.children[0].innerText,a=n.children[1].innerText,l=C(a,c,o);t.appendChild(l)})},ne=(e,t)=>{e.defaultValue=t,e.placeholder=t},ce=(e,t)=>{Array.from(e.getElementsByTagName("input")).forEach(n=>{t.includes(n.name)&&(n.checked=!0)})},xe=(e,t)=>{var n;const o=(n=e.options.namedItem(t))==null?void 0:n.index;o&&(e.options.selectedIndex=o)};var Ce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:E,addCheckBox:C,mapCollectionSelector:p,mapCollectionCheckBox:v,setDefaultInput:ne,setDefaultCheckboxes:ce,setDefaultOption:xe});const je=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),se=async e=>{const[t,o]=await Promise.all([je(e),K(e.name,e.type)]);if(!o.ok)throw new Error("Could not get url upload");const{uploadUrl:n}=await o.json(),c=await V(n,t);if(!c.ok)throw new Error("Could not upload the image");return c.url},Fe=["image/jpeg","image/png","image/jpg"],Ue=e=>Fe.includes(e.type)?e.size>5*10**6?"File is too big.":"ok":"File type is invalid",_e=(e,t,o)=>{e.addEventListener("change",n=>{const c=n.target.files[0],a=Ue(c);a==="ok"?(console.log("File",n.target.files[0]),t.src=URL.createObjectURL(n.target.files[0])):o.innerText=a}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var Oe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:se,previewImage:_e});const Ne=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),r=e=>e&&e[e.selectedIndex].value,Pe=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),b=(e,t)=>Array.from(e).filter(o=>o.checked&&(t?o.getAttribute("data-type")===t:1)).map(o=>o.name).filter(o=>o);var Me=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:Ne,uniSelect:r,multiCheckbox:Pe,multiCheckboxFromEl:b});const ae=()=>{var n,c,a,l,u,i,d,h,re,ie;const e=m.elements,t=m.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",gender:r(e.gender.options)||"",dob:((a=e.dob)==null?void 0:a.value)||"",postcode:((l=e.postcode)==null?void 0:l.value)||"","cancer-type":r((u=e["cancer-type"])==null?void 0:u.options)||"","cancer-stage":r((i=e["cancer-stage"])==null?void 0:i.options)||"","treatment-type":r((d=e["treatment-type"])==null?void 0:d.options)||"","treatment-stage":r((h=e["treatment-stage"])==null?void 0:h.options)||"","side-effects":b(t,"side-effect"),eat:r((re=e.eat)==null?void 0:re.options)||"",move:r((ie=e.move)==null?void 0:ie.options)||"",live:b(t,"live")}},le=()=>{var n,c,a,l,u,i,d,h;const e=w.elements,t=w.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",bio:((a=e.bio)==null?void 0:a.value)||"",job:r((l=e.job)==null?void 0:l.options)||"","job-title":((u=e.job)==null?void 0:u.value)||"",address:((i=e.address)==null?void 0:i.value)||"",phone:((d=e.phone)==null?void 0:d.value)||"",website:((h=e.website)==null?void 0:h.value)||"","side-effects":b(t,"side-effect"),lifestyles:b(t,"lifestyle")}},Ae=()=>{v($,S,"lifestyle"),console.log("Create"),v(B,k,"side-effect"),p(R,P)},Le=()=>{p(q,U),p(z,_),p(L,j),p(D,F),v(B,k,"side-effect"),Object.values(W).map(e=>{const t=e.children[0].innerText,o=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":E(O,o,t);break;case"Move":E(N,o,t);break;case"Live":const c=C(o,t,"live");M.appendChild(c);break}})},De=async e=>{e.preventDefault(),X();try{const t=ae();let o="620f78370eeeb2cc10a23e94";t["webflow-id"]=o;const n=await G(t);if(!n.ok)throw new Error("Network response was not OK");te("Success");const c=await n.json();window.location.replace(window.location.href+"/user/"+c.result.slug)}catch(t){Z("Could not update your information",t)}finally{Y()}},qe=async e=>{var t;e.preventDefault(),X();try{const o=le();let n="6213eae0fae77e75cf3dc004";o["webflow-id"]=n;const c=w.elements;let a="";if(((t=c.picture)==null?void 0:t.files)&&c.picture.files[0])try{const i=c.picture.files[0],d=await se(i);console.log("Image Url",d),o.image=d}catch(i){a="Could not upload your image",console.log(a,i)}const l=await Q(o);if(!l.ok)throw new Error("Network response was not OK");te("Success");const u=await l.json();window.location.replace(window.location.href+"/user/"+u.result.slug)}catch(o){Z("Could not update your information",o)}finally{Y()}},ze=()=>{ne(A,x.firstName),ce(S,x.lifestyles.split(","))};s.api=Ie,s.cf=Ce,s.collection=ve,s.createProFormFields=Ae,s.createUserFormFields=Le,s.gf=Me,s.mapProFieldToBody=le,s.mapUserFieldToBody=ae,s.populateDefaults=ze,s.selector=Te,s.submitProForm=qe,s.submitUserForm=De,s.upload=Oe,Object.defineProperty(s,"__esModule",{value:!0}),s[Symbol.toStringTag]="Module"});
