(function(c,p){typeof exports=="object"&&typeof module!="undefined"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(c=typeof globalThis!="undefined"?globalThis:c||self,p(c.oncana={}))})(this,function(c){"use strict";const p=document.querySelector("#user-form"),T=document.querySelector("#pro-form"),g=document.querySelector(".loader"),f=document.querySelector(".error-msg"),b=document.querySelector(".success-msg"),I=document.getElementById("select-cancer-type"),j=document.getElementById("select-cancer-stage"),U=document.getElementById("select-treatment-type"),F=document.getElementById("select-treatment-stage"),_=document.getElementById("select-eat"),N=document.getElementById("select-move"),O=document.getElementById("select-job"),x=document.getElementById("checkboxes-side-effects"),P=document.getElementById("checkboxes-lives"),k=document.getElementById("checkboxes-lifestyles"),ie=document.getElementById("checkboxes-categories"),de=document.getElementById("image-input"),me=document.getElementById("image-preview"),ue=document.getElementById("image-upload"),pe=document.getElementById("image-feedback"),A=document.getElementById("first-name"),ye=document.getElementById("bio"),ge=document.getElementById("last-name"),fe=document.getElementById("phone"),be=document.getElementById("job-title"),he=document.getElementById("oncana-categories");var Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",userForm:p,proForm:T,loader:g,errorMsg:f,successMsg:b,cancerType:I,cancerStage:j,treatmentType:U,treatmentStage:F,eat:_,move:N,job:O,sideEffectWrapper:x,liveWrapper:P,lifestyleWrapper:k,categoryWrapper:ie,imageInput:de,imagePreview:me,imageUpload:ue,imageFeedback:pe,firstName:A,bio:ye,lastName:ge,phone:fe,jobTitle:be,oncanaCategories:he});const M=document.getElementsByClassName("cancer-type-item"),L=document.getElementsByClassName("cancer-stage-item"),D=document.getElementsByClassName("treatment-type-item"),q=document.getElementsByClassName("treatment-stage-item"),C=document.getElementsByClassName("side-effect-item"),z=document.getElementsByClassName("category-item"),W=document.getElementsByClassName("lifestyle-item"),$=document.getElementsByClassName("job-item"),S=document.getElementsByClassName("collection-page-item"),R=()=>{var t,o,n,s,a,r,d,l,i,u;const e=Array.from(S[0].children);return{firstName:((t=e[0])==null?void 0:t.innerText)||"",lastName:((o=e[1])==null?void 0:o.innerText)||"",bio:((n=e[2])==null?void 0:n.innerText)||"",phone:((s=e[3])==null?void 0:s.innerText)||"",postCode:((a=e[4])==null?void 0:a.innerText)||"",street:((r=e[5])==null?void 0:r.innerText)||"",website:((d=e[6])==null?void 0:d.innerText)||"",itemId:((l=e[7])==null?void 0:l.innerText)||"","selected-lifestyles":((i=e[8])==null?void 0:i.innerText)||"","selected-categories":((u=e[9])==null?void 0:u.innerText)||""}},we=()=>{var t;return{firstName:((t=Array.from(S[0].children)[0])==null?void 0:t.innerText)||""}};var Ee=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",cancerType:M,cancerStage:L,treatmentType:D,treatmentStage:q,sideEffect:C,category:z,lifestyle:W,job:$,cpItem:S,getCurrentPro:R,getCurrentUser:we});const w="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",ve=w+"/webflow/user",xe=w+"/webflow/pro",ke=w+"/get-presigned-url",J={"Content-Type":"application/json",Accept:"*"},H=(e,t)=>fetch(ke,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),K=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),V=e=>fetch(ve,{method:"PATCH",headers:J,body:JSON.stringify(e)}),G=e=>fetch(xe,{method:"PATCH",headers:J,body:JSON.stringify(e)});var Ce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:w,getUploadUrl:H,uploadToS3:K,updateUser:V,updatePro:G});const Q=()=>{Z(),te(),g.style.display="flex",g.innerText="Loading"},X=()=>{g.style.display="none",g.innerText=""},Y=(e,t)=>{console.log(e,t),f.style.display="flex",f.innerText=e,setTimeout(()=>{Z()},3e3)},Z=()=>{f.style.display="none",f.innerText=""},ee=e=>{b.style.display="flex",b.innerText=e,setTimeout(()=>{te()},3e3)},te=()=>{b.style.display="none",b.innerText=""},E=(e,t,o)=>{e&&t&&o&&e.options.add(new Option(o,t))},B=(e,t,o)=>{const n=document.createElement("label"),s=document.createElement("input");s.type="checkbox",s.name=e,s.setAttribute("data-type",o);const a=document.createElement("span");a.className="checkmark";const r=document.createElement("span");return r.className="checktext",r.innerText=t,n.appendChild(s),n.appendChild(a),n.appendChild(r),n},y=(e,t)=>{Object.values(e).map(o=>{const n=o.children[0].innerText,s=o.children[1].innerText;E(t,s,n)})},v=(e,t,o)=>{Object.values(e).map(n=>{const s=n.children[0].innerText,a=n.children[1].innerText,r=B(a,s,o);t.appendChild(r)})},oe=(e,t)=>{e.defaultValue=t,e.placeholder=t},ne=(e,t)=>{Array.from(e.getElementsByTagName("input")).forEach(n=>{t.includes(n.name)&&(n.checked=!0)})},Se=(e,t)=>{var n;const o=(n=e.options.namedItem(t))==null?void 0:n.index;o&&(e.options.selectedIndex=o)};var Be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:E,addCheckBox:B,mapCollectionSelector:y,mapCollectionCheckBox:v,setDefaultInput:oe,setDefaultCheckboxes:ne,setDefaultOption:Se});const Ie=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),se=async e=>{const[t,o]=await Promise.all([Ie(e),H(e.name,e.type)]);if(!o.ok)throw new Error("Could not get url upload");const{uploadUrl:n}=await o.json(),s=await K(n,t);if(!s.ok)throw new Error("Could not upload the image");return s.url},je=["image/jpeg","image/png","image/jpg"],Ue=e=>je.includes(e.type)?e.size>5*10**6?"File is too big.":"ok":"File type is invalid",Fe=(e,t,o)=>{e.addEventListener("change",n=>{const s=n.target.files[0],a=Ue(s);a==="ok"?(console.log("File",n.target.files[0]),t.src=URL.createObjectURL(n.target.files[0])):o.innerText=a}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var _e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:se,previewImage:Fe});const Ne=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),m=e=>e&&e[e.selectedIndex].value,Oe=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),h=(e,t)=>Array.from(e).filter(o=>o.checked&&(t?o.getAttribute("data-type")===t:1)).map(o=>o.name).filter(o=>o);var Pe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:Ne,uniSelect:m,multiCheckbox:Oe,multiCheckboxFromEl:h});const ce=()=>{var n,s,a,r,d,l,i,u,re,le;const e=p.elements,t=p.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((s=e["last-name"])==null?void 0:s.value)||"",gender:m(e.gender.options)||"",dob:((a=e.dob)==null?void 0:a.value)||"",postcode:((r=e.postcode)==null?void 0:r.value)||"","cancer-type":m((d=e["cancer-type"])==null?void 0:d.options)||"","cancer-stage":m((l=e["cancer-stage"])==null?void 0:l.options)||"","treatment-type":m((i=e["treatment-type"])==null?void 0:i.options)||"","treatment-stage":m((u=e["treatment-stage"])==null?void 0:u.options)||"","side-effects":h(t,"side-effect"),eat:m((re=e.eat)==null?void 0:re.options)||"",move:m((le=e.move)==null?void 0:le.options)||"",live:h(t,"live")}},ae=()=>{var n,s,a,r,d,l,i,u;const e=T.elements,t=T.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((s=e["last-name"])==null?void 0:s.value)||"",bio:((a=e.bio)==null?void 0:a.value)||"",job:m((r=e.job)==null?void 0:r.options)||"","job-title":((d=e.job)==null?void 0:d.value)||"",address:((l=e.address)==null?void 0:l.value)||"",phone:((i=e.phone)==null?void 0:i.value)||"",website:((u=e.website)==null?void 0:u.value)||"","side-effects":h(t,"side-effect"),lifestyles:h(t,"lifestyle")}},Ae=()=>{v(W,k,"lifestyle"),console.log("Create"),v(C,x,"side-effect"),y($,O)},Me=()=>{y(D,U),y(q,F),y(M,I),y(L,j),v(C,x,"side-effect"),Object.values(z).map(e=>{const t=e.children[0].innerText,o=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":E(_,o,t);break;case"Move":E(N,o,t);break;case"Live":const s=B(o,t,"live");P.appendChild(s);break}})},Le=async e=>{e.preventDefault(),Q();try{const t=ce();let o="620f78370eeeb2cc10a23e94";t["webflow-id"]=o;const n=await V(t);if(!n.ok)throw new Error("Network response was not OK");ee("Success");const s=await n.json();window.location.replace(window.location.href+"/user/"+s.result.slug)}catch(t){Y("Could not update your information",t)}finally{X()}},De=async e=>{var t;e.preventDefault(),Q();try{const o=ae();let n="6213eae0fae77e75cf3dc004";o["webflow-id"]=n;const s=T.elements;let a="";if(((t=s.picture)==null?void 0:t.files)&&s.picture.files[0])try{const l=s.picture.files[0],i=await se(l);console.log("Image Url",i),o.image=i}catch(l){a="Could not upload your image",console.log(a,l)}const r=await G(o);if(!r.ok)throw new Error("Network response was not OK");ee("Success");const d=await r.json();window.location.replace(window.location.href+"/user/"+d.result.slug)}catch(o){Y("Could not update your information",o)}finally{X()}},qe=()=>{const e=R();oe(A,e.firstName),ne(k,e["selected-lifestyles"].split(","))};c.api=Ce,c.cf=Be,c.collection=Ee,c.createProFormFields=Ae,c.createUserFormFields=Me,c.gf=Pe,c.mapProFieldToBody=ae,c.mapUserFieldToBody=ce,c.populateDefaults=qe,c.selector=Te,c.submitProForm=De,c.submitUserForm=Le,c.upload=_e,Object.defineProperty(c,"__esModule",{value:!0}),c[Symbol.toStringTag]="Module"});
