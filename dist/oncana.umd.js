(function(s,r){typeof exports=="object"&&typeof module!="undefined"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(s=typeof globalThis!="undefined"?globalThis:s||self,r(s.oncana={}))})(this,function(s){"use strict";const r=document.querySelector("#onboarding"),y=document.querySelector(".loader"),g=document.querySelector(".error-msg"),f=document.querySelector(".success-msg"),j=document.getElementById("select-cancer-type"),U=document.getElementById("select-cancer-stage"),_=document.getElementById("select-treatment-type"),O=document.getElementById("select-treatment-stage"),F=document.getElementById("select-eat"),N=document.getElementById("select-move"),P=document.getElementById("select-job"),v=document.getElementById("checkboxes-side-effects"),M=document.getElementById("checkboxes-lives"),k=document.getElementById("checkboxes-lifestyles"),ge=document.getElementById("checkboxes-categories"),A=document.getElementById("image-input"),L=document.getElementById("image-preview"),fe=document.getElementById("image-upload"),D=document.getElementById("image-feedback"),z=document.getElementById("first-name"),be=document.getElementById("bio"),he=document.getElementById("last-name"),we=document.getElementById("phone"),Te=document.getElementById("job-title"),Ee=document.getElementById("oncana-categories");var ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",form:r,loader:y,errorMsg:g,successMsg:f,cancerType:j,cancerStage:U,treatmentType:_,treatmentStage:O,eat:F,move:N,job:P,sideEffectWrapper:v,live:M,lifestyleWrapper:k,categoryWrapper:ge,imageInput:A,imagePreview:L,imageUpload:fe,imageFeedback:D,firstName:z,bio:be,lastName:he,phone:we,jobTitle:Te,oncanaCategories:Ee});const q=document.getElementsByClassName("cancer-type-item"),W=document.getElementsByClassName("cancer-stage-item"),$=document.getElementsByClassName("treatment-type-item"),R=document.getElementsByClassName("treatment-stage-item"),B=document.getElementsByClassName("side-effect-item"),J=document.getElementsByClassName("category-item"),H=document.getElementsByClassName("lifestyle-item"),K=document.getElementsByClassName("job-item"),V=document.getElementsByClassName("collection-page-item"),S=Array.from(V[0].children),I={firstName:S[0].innerText,lifestyles:S[3].innerText},ke={firstName:S[0].innerText};var Be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",cancerType:q,cancerStage:W,treatmentType:$,treatmentStage:R,sideEffect:B,category:J,lifestyle:H,job:K,cpItem:V,pro:I,user:ke});const w="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",Se=w+"/webflow/user",Ie=w+"/webflow/pro",xe=w+"/get-presigned-url",G={"Content-Type":"application/json",Accept:"*"},Q=(e,t)=>fetch(xe,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),X=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),x=e=>fetch(Se,{method:"PATCH",headers:G,body:JSON.stringify(e)}),Ce=e=>fetch(Ie,{method:"PATCH",headers:G,body:JSON.stringify(e)});var je=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:w,getUploadUrl:Q,uploadToS3:X,updateUser:x,updatePro:Ce});const Y=()=>{te(),ne(),y.style.display="flex",y.innerText="Loading"},Z=()=>{y.style.display="none",y.innerText=""},ee=(e,t)=>{console.log(e,t),g.style.display="flex",g.innerText=e,setTimeout(()=>{te()},3e3)},te=()=>{g.style.display="none",g.innerText=""},oe=e=>{f.style.display="flex",f.innerText=e,setTimeout(()=>{ne()},3e3)},ne=()=>{f.style.display="none",f.innerText=""},T=(e,t,o)=>{e&&t&&o&&e.options.add(new Option(o,t))},C=(e,t,o)=>{const n=document.createElement("label"),c=document.createElement("input");c.type="checkbox",c.name=e,c.setAttribute("data-type",o);const a=document.createElement("span");a.className="checkmark";const l=document.createElement("span");return l.className="checktext",l.innerText=t,n.appendChild(c),n.appendChild(a),n.appendChild(l),n},p=(e,t)=>{Object.values(e).map(o=>{const n=o.children[0].innerText,c=o.children[1].innerText;T(t,c,n)})},E=(e,t,o)=>{Object.values(e).map(n=>{const c=n.children[0].innerText,a=n.children[1].innerText,l=C(a,c,o);t.appendChild(l)})},ce=(e,t)=>{e.defaultValue=t,e.placeholder=t},se=(e,t)=>{Array.from(e.getElementsByTagName("input")).forEach(n=>{t.includes(n.name)&&(n.checked=!0)})},Ue=(e,t)=>{var n;const o=(n=e.options.namedItem(t))==null?void 0:n.index;o&&(e.options.selectedIndex=o)};var _e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:T,addCheckBox:C,mapCollectionSelector:p,mapCollectionCheckBox:E,setDefaultInput:ce,setDefaultCheckboxes:se,setDefaultOption:Ue});const Oe=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),ae=async e=>{const[t,o]=await Promise.all([Oe(e),Q(e.name,e.type)]);if(!o.ok)throw new Error("Could not get url upload");const{uploadUrl:n}=await o.json(),c=await X(n,t);if(!c.ok)throw new Error("Could not upload the image");return c.url},Fe=["image/jpeg","image/png","image/jpg"],Ne=e=>Fe.includes(e.type)?e.size>5*10**6?"File is too big.":"ok":"File type is invalid",le=(e,t,o)=>{e.addEventListener("change",n=>{const c=n.target.files[0],a=Ne(c);a==="ok"?(console.log("File",n.target.files[0]),t.src=URL.createObjectURL(n.target.files[0])):o.innerText=a}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var Pe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:ae,previewImage:le});const Me=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),i=e=>e&&e[e.selectedIndex].value,Ae=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),b=(e,t)=>Array.from(e).filter(o=>o.checked&&(t?o.getAttribute("data-type")===t:1)).map(o=>o.name).filter(o=>o);var Le=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:Me,uniSelect:i,multiCheckbox:Ae,multiCheckboxFromEl:b});const re=()=>{var n,c,a,l,u,d,m,h,pe,ye;const e=r.elements,t=r.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",gender:i(e.gender.options)||"",dob:((a=e.dob)==null?void 0:a.value)||"",postcode:((l=e.postcode)==null?void 0:l.value)||"","cancer-type":i((u=e["cancer-type"])==null?void 0:u.options)||"","cancer-stage":i((d=e["cancer-stage"])==null?void 0:d.options)||"","treatment-type":i((m=e["treatment-type"])==null?void 0:m.options)||"","treatment-stage":i((h=e["treatment-stage"])==null?void 0:h.options)||"","side-effects":b(t,"side-effect"),eat:i((pe=e.eat)==null?void 0:pe.options)||"",move:i((ye=e.move)==null?void 0:ye.options)||"",live:b(t,"live")}},ie=()=>{var n,c,a,l,u,d,m,h;const e=r.elements,t=r.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",bio:((a=e.bio)==null?void 0:a.value)||"",job:i((l=e.job)==null?void 0:l.options)||"","job-title":((u=e.job)==null?void 0:u.value)||"",address:((d=e.address)==null?void 0:d.value)||"",phone:((m=e.phone)==null?void 0:m.value)||"",website:((h=e.website)==null?void 0:h.value)||"","side-effects":b(t,"side-effect"),lifestyles:b(t,"lifestyle")}},De=()=>{E(H,k,"lifestyle"),E(B,v,"side-effect"),p(K,P)},de=()=>{p($,_),p(R,O),p(q,j),p(W,U),E(B,v,"side-effect"),Object.values(J).map(e=>{const t=e.children[0].innerText,o=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":T(F,o,t);break;case"Move":T(N,o,t);break;case"Live":const c=C(o,t,"live");M.appendChild(c);break}})},ze=async e=>{e.preventDefault(),Y();try{const t=re();let o="620f78370eeeb2cc10a23e94";t["webflow-id"]=o;const n=await x(t);if(!n.ok)throw new Error("Network response was not OK");oe("Success");const c=await n.json();window.location.replace(window.location.href+"/user/"+c.result.slug)}catch(t){ee("Could not update your information",t)}finally{Z()}},me=async e=>{var t;e.preventDefault(),Y();try{const o=ie();let n="6213eae0fae77e75cf3dc004";o["webflow-id"]=n;const c=r.elements;let a="";if(((t=c.picture)==null?void 0:t.files)&&c.picture.files[0])try{const d=c.picture.files[0],m=await ae(d);console.log("Image Url",m),o.image=m}catch(d){a="Could not upload your image",console.log(a,d)}const l=await x(o);if(!l.ok)throw new Error("Network response was not OK");oe("Success");const u=await l.json();window.location.replace(window.location.href+"/user/"+u.result.slug)}catch(o){ee("Could not update your information",o)}finally{Z()}},ue=()=>{ce(z,I.firstName),se(k,I.lifestyles.split(","))};le(A,L,D),de(),ue(),r.addEventListener("submit",me),s.api=je,s.cf=_e,s.collection=Be,s.createProFormFields=De,s.createUserFormFields=de,s.gf=Le,s.mapProFieldToBody=ie,s.mapUserFieldToBody=re,s.populateDefaults=ue,s.selector=ve,s.submitProForm=me,s.submitUserForm=ze,s.upload=Pe,Object.defineProperty(s,"__esModule",{value:!0}),s[Symbol.toStringTag]="Module"});
