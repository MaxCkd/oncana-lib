(function(a,s){typeof exports=="object"&&typeof module!="undefined"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(a=typeof globalThis!="undefined"?globalThis:a||self,s(a.oncana={}))})(this,function(a){"use strict";const s=document.querySelector(".loader"),i=document.querySelector("#onboarding"),p=document.getElementById("select-cancer-type"),u=document.getElementById("select-cancer-stage"),y=document.getElementById("select-treatment-type"),f=document.getElementById("select-treatment-stage"),g=document.getElementById("select-eat"),h=document.getElementById("select-move"),b=document.getElementById("checkboxes-side-effect"),E=document.getElementById("checkboxes-live");var C=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loader:s,form:i,cancerType:p,cancerStage:u,treatmentType:y,treatmentStage:f,eat:g,move:h,sideEffectWrapper:b,live:E});const k=document.getElementsByClassName("cancer-type-item"),v=document.getElementsByClassName("cancer-stage-item"),x=document.getElementsByClassName("treatment-type-item"),B=document.getElementsByClassName("treatment-stage-item"),S=document.getElementsByClassName("side-effect-item"),I=document.getElementsByClassName("category-item"),T={}.API,O=T+"/webflow",N=T+"/get-presigned-url",U={"Content-Type":"application/json",Accept:"*"},A=(e,t)=>fetch(N,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),j=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),F=e=>fetch(O,{method:"PATCH",headers:U,body:JSON.stringify(e)}),P=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),_=async e=>{const[t,n]=await Promise.all([P(e),A(e.name,e.type)]);if(!n.ok)throw new Error("Could not get url upload");const{uploadUrl:c}=await n.json(),o=await j(c,t);if(!o.ok)throw new Error("Could not upload the image");return o.url},M=e=>e[e.selectedIndex].value,$=(e,t)=>Array.from(e).filter(n=>n.checked&&(t?n.getAttribute("data-type")===t:1)).map(n=>n.name).filter(n=>n),q=async e=>{e.preventDefault(),s&&(s.style.display="fixed");const t=i.elements,n=i.querySelectorAll('input[type="checkbox"]'),c={"webflow-id":t["webflow-id"].value,"first-name":t["first-name"].value,"last-name":t["last-name"].value,dob:t.dob.value,gender:M(t.gender.options),"side-effects":$(n,"side-effect")};if(t.pic.files&&t.pic.files[0])try{const o=t.pic.files[0],r=await _(o);console.log("Image",r),c.image=r}catch(o){console.log(o)}try{if(!(await F(c)).ok)throw console.log("Error"),new Error("Network response was not OK");console.log("Success")}catch(o){console.log(o)}finally{s&&(s.style.display="fixed")}},m=(e,t,n)=>{t&&n&&e.options.add(new Option(t,n))},w=(e,t,n)=>{const c=document.createElement("label"),o=document.createElement("input");o.type="checkbox",o.name=e,o.setAttribute("data-type",n);const r=document.createElement("span");r.className="checkmark";const l=document.createElement("span");return l.className="checktext",l.innerText=t,c.appendChild(o),c.appendChild(r),c.appendChild(l),c},d=(e,t)=>{Object.values(e).map(n=>{m(t,n.children[0].innerText,n.children[1].innerText)})},J=(e,t,n)=>{Object.values(e).map(c=>{const o=c.children[0].innerText,r=c.children[1].innerText,l=w(o,r,n);t.appendChild(l)})},L=()=>{d(x,y),d(B,f),d(k,p),d(v,u),J(S,b,"side-effect"),Object.values(I).map(e=>{const t=e.children[2].innerText,n=e.children[0].innerText,c=e.children[1].innerText;switch(t){case"Eat":m(g,n,c);break;case"Move":m(h,n,c);break;case"Live":const o=w(n,c,"live");E.appendChild(o);break}})};a.createFieldsFromCollections=L,a.selector=C,a.submitOnboardingForm=q,Object.defineProperty(a,"__esModule",{value:!0}),a[Symbol.toStringTag]="Module"});
