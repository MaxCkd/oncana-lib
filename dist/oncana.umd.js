(function(s,a){typeof exports=="object"&&typeof module!="undefined"?a(exports):typeof define=="function"&&define.amd?define(["exports"],a):(s=typeof globalThis!="undefined"?globalThis:s||self,a(s.oncana={}))})(this,function(s){"use strict";const a=document.querySelector("#onboarding"),l=document.querySelector(".loader"),i=document.querySelector(".error-msg"),d=document.querySelector(".success-msg"),v=document.getElementById("select-cancer-type"),w=document.getElementById("select-cancer-stage"),T=document.getElementById("select-treatment-type"),S=document.getElementById("select-treatment-stage"),k=document.getElementById("select-eat"),E=document.getElementById("select-move"),C=document.getElementById("checkboxes-side-effect"),x=document.getElementById("checkboxes-live"),A=document.getElementById("image-input"),P=document.getElementById("image-preview");var q=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",form:a,loader:l,errorMsg:i,successMsg:d,cancerType:v,cancerStage:w,treatmentType:T,treatmentStage:S,eat:k,move:E,sideEffectWrapper:C,live:x,imageInput:A,imagePreview:P});const z=document.getElementsByClassName("cancer-type-item"),$=document.getElementsByClassName("cancer-stage-item"),R=document.getElementsByClassName("treatment-type-item"),D=document.getElementsByClassName("treatment-stage-item"),J=document.getElementsByClassName("side-effect-item"),K=document.getElementsByClassName("category-item"),B=()=>{I(),j(),l.style.display="flex",l.innerText="Loading"},O=()=>{l.style.display="none",l.innerText=""},_=(e,t)=>{i.style.display="flex",i.innerText=e,setTimeout(()=>{I()},3e3)},I=()=>{i.style.display="none",i.innerText=""},U=e=>{d.style.display="flex",d.innerText=e,setTimeout(()=>{j()},3e3)},j=()=>{d.style.display="none",d.innerText=""},p=(e,t,n)=>{t&&n&&e.options.add(new Option(t,n))},y=(e,t,n)=>{const c=document.createElement("label"),o=document.createElement("input");o.type="checkbox",o.name=e,o.setAttribute("data-type",n);const r=document.createElement("span");r.className="checkmark";const u=document.createElement("span");return u.className="checktext",u.innerText=t,c.appendChild(o),c.appendChild(r),c.appendChild(u),c},m=(e,t)=>{Object.values(e).map(n=>{p(t,n.children[0].innerText,n.children[1].innerText)})},F=(e,t,n)=>{Object.values(e).map(c=>{const o=c.children[0].innerText,r=c.children[1].innerText,u=y(o,r,n);t.appendChild(u)})};var W=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:p,addCheckBox:y,mapCollectionSelector:m,mapCollectionCheckBox:F});const H=e=>Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),g=e=>e[e.selectedIndex].value,G=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),f=(e,t)=>Array.from(e).filter(n=>n.checked&&(t?n.getAttribute("data-type")===t:1)).map(n=>n.name).filter(n=>n);var Q=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:H,uniSelect:g,multiCheckbox:G,multiCheckboxFromEl:f});const V=()=>{const e=a.elements,t=a.querySelectorAll('input[type="checkbox"]');return{"webflow-id":e["webflow-id"].value,"first-name":e["first-name"].value,"last-name":e["last-name"].value,dob:e.dob.value,gender:g(e.gender.options),"side-effects":f(t,"side-effect")}},X=()=>{const e=a.elements,t=a.querySelectorAll('input[type="checkbox"]');return{"webflow-id":e["webflow-id"].value,"first-name":e["first-name"].value,"last-name":e["last-name"].value,dob:e.dob.value,gender:g(e.gender.options),"side-effects":f(t,"side-effect")}},b="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",Y=b+"/webflow",Z=b+"/get-presigned-url",ee={"Content-Type":"application/json",Accept:"*"},M=(e,t)=>fetch(Z,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),N=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),h=e=>fetch(Y,{method:"PATCH",headers:ee,body:JSON.stringify(e)});var te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:b,getUploadUrl:M,uploadToS3:N,updateUser:h});const ne=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),L=async e=>{const[t,n]=await Promise.all([ne(e),M(e.name,e.type)]);if(!n.ok)throw new Error("Could not get url upload");const{uploadUrl:c}=await n.json(),o=await N(c,t);if(!o.ok)throw new Error("Could not upload the image");return o.url},oe=(e,t)=>{e.addEventListener("change",n=>{t.src=URL.createObjectURL(n.target.files[0])}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var ce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:L,previewImage:oe});const se=()=>{m(R,T),m(D,S),m(z,v),m($,w),F(J,C,"side-effect"),Object.values(K).map(e=>{const t=e.children[2].innerText,n=e.children[0].innerText,c=e.children[1].innerText;switch(t){case"Eat":p(k,n,c);break;case"Move":p(E,n,c);break;case"Live":const o=y(n,c,"live");x.appendChild(o);break}})},ae=async e=>{e.preventDefault(),B();try{const t=V();if(!(await h(t)).ok)throw new Error("Network response was not OK");U("Success")}catch{_("Could not update your information")}finally{O()}},re=async e=>{e.preventDefault(),B();const t=a.elements,n=X();let c="";if(t.pic.files&&t.pic.files[0])try{const o=t.pic.files[0],r=await L(o);n.image=r}catch(o){c="Could not upload your image",console.log(c,o)}try{if(!(await h(n)).ok)throw new Error("Network response was not OK");U("Success")}catch{_("Could not update your information")}finally{O()}};s.api=te,s.cf=W,s.createFieldsFromCollections=se,s.gf=Q,s.selector=q,s.submitOnboardingForm=ae,s.submitProfessionalForm=re,s.upload=ce,Object.defineProperty(s,"__esModule",{value:!0}),s[Symbol.toStringTag]="Module"});
