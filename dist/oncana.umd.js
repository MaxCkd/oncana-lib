(function(a,r){typeof exports=="object"&&typeof module!="undefined"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(a=typeof globalThis!="undefined"?globalThis:a||self,r(a.oncana={}))})(this,function(a){"use strict";const r=document.querySelector("#onboarding"),m=document.querySelector(".loader"),u=document.querySelector(".error-msg"),p=document.querySelector(".success-msg"),S=document.getElementById("select-cancer-type"),k=document.getElementById("select-cancer-stage"),w=document.getElementById("select-treatment-type"),B=document.getElementById("select-treatment-stage"),C=document.getElementById("select-eat"),x=document.getElementById("select-move"),I=document.getElementById("checkboxes-side-effect"),_=document.getElementById("checkboxes-live"),Q=document.getElementById("image-input"),X=document.getElementById("image-preview"),Y=document.getElementById("image-upload"),Z=document.getElementById("image-feedback"),O=document.getElementById("first-name"),ee=document.getElementById("bio"),te=document.getElementById("last-name");var ne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",form:r,loader:m,errorMsg:u,successMsg:p,cancerType:S,cancerStage:k,treatmentType:w,treatmentStage:B,eat:C,move:x,sideEffectWrapper:I,live:_,imageInput:Q,imagePreview:X,imageUpload:Y,imageFeedback:Z,firstName:O,bio:ee,lastName:te});const U=document.getElementsByClassName("cancer-type-item"),j=document.getElementsByClassName("cancer-stage-item"),N=document.getElementsByClassName("treatment-type-item"),F=document.getElementsByClassName("treatment-stage-item"),M=document.getElementsByClassName("side-effect-item"),A=document.getElementsByClassName("category-item"),L=document.getElementsByClassName("collection-page-item"),P={firstName:Array.from(L[0].children)[0].innerText};var oe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",cancerType:U,cancerStage:j,treatmentType:N,treatmentStage:F,sideEffect:M,category:A,cpItem:L,pro:P});const v="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",ce=v+"/webflow",ae=v+"/get-presigned-url",se={"Content-Type":"application/json",Accept:"*"},z=(e,t)=>fetch(ae,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),q=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),D=e=>fetch(ce,{method:"PATCH",headers:se,body:JSON.stringify(e)});var le=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:v,getUploadUrl:z,uploadToS3:q,updateUser:D});const re=()=>{$(),R(),m.style.display="flex",m.innerText="Loading"},ie=()=>{m.style.display="none",m.innerText=""},de=(e,t)=>{console.log(e,t),u.style.display="flex",u.innerText=e,setTimeout(()=>{$()},3e3)},$=()=>{u.style.display="none",u.innerText=""},me=e=>{p.style.display="flex",p.innerText=e,setTimeout(()=>{R()},3e3)},R=()=>{p.style.display="none",p.innerText=""},f=(e,t,n)=>{e&&t&&n&&e.options.add(new Option(n,t))},E=(e,t,n)=>{const o=document.createElement("label"),c=document.createElement("input");c.type="checkbox",c.name=e,c.setAttribute("data-type",n);const s=document.createElement("span");s.className="checkmark";const l=document.createElement("span");return l.className="checktext",l.innerText=t,o.appendChild(c),o.appendChild(s),o.appendChild(l),o},g=(e,t)=>{Object.values(e).map(n=>{const o=n.children[0].innerText,c=n.children[1].innerText;f(t,c,o)})},J=(e,t,n)=>{Object.values(e).map(o=>{const c=o.children[0].innerText,s=o.children[1].innerText,l=E(s,c,n);t.appendChild(l)})},V=(e,t)=>{e.defaultValue=t,e.placeholder=t};var ue=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:f,addCheckBox:E,mapCollectionSelector:g,mapCollectionCheckBox:J,setDefaultInput:V});const pe=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),W=async e=>{const[t,n]=await Promise.all([pe(e),z(e.name,e.type)]);if(!n.ok)throw new Error("Could not get url upload");const{uploadUrl:o}=await n.json(),c=await q(o,t);if(!c.ok)throw new Error("Could not upload the image");return c.url},ge=["image/jpeg","image/png","image/jpg"],ye=e=>ge.includes(e.type)?e.size>5*10**6?"File is too big.":"ok":"File type is invalid",fe=(e,t,n)=>{e.addEventListener("change",o=>{const c=o.target.files[0],s=ye(c);s==="ok"?(console.log("File",o.target.files[0]),t.src=URL.createObjectURL(o.target.files[0])):n.innerText=s}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:W,previewImage:fe});const he=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),i=e=>e&&e[e.selectedIndex].value,Te=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),b=(e,t)=>Array.from(e).filter(n=>n.checked&&(t?n.getAttribute("data-type")===t:1)).map(n=>n.name).filter(n=>n);var ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:he,uniSelect:i,multiCheckbox:Te,multiCheckboxFromEl:b});const H=()=>{var o,c,s,l,y,h,d,T,K,G;const e=r.elements,t=r.querySelectorAll('input[type="checkbox"]');return{"first-name":((o=e["first-name"])==null?void 0:o.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",gender:i(e.gender.options)||"",dob:((s=e.dob)==null?void 0:s.value)||"",postcode:((l=e.postcode)==null?void 0:l.value)||"","cancer-type":i((y=e["cancer-type"])==null?void 0:y.options)||"","cancer-stage":i((h=e["cancer-stage"])==null?void 0:h.options)||"","treatment-type":i((d=e["treatment-type"])==null?void 0:d.options)||"","treatment-stage":i((T=e["treatment-stage"])==null?void 0:T.options)||"","side-effects":b(t,"side-effect"),eat:i((K=e.eat)==null?void 0:K.options)||"",move:i((G=e.move)==null?void 0:G.options)||"",live:b(t,"live")}},Ee=()=>{const e=r.elements,t=r.querySelectorAll('input[type="checkbox"]');return{"first-name":e["first-name"].value,"last-name":e["last-name"].value,dob:e.dob.value,gender:i(e.gender.options),"side-effects":b(t,"side-effect")}},Se=document.getElementsByTagName("button");for(let e of Array.from(Se))e.disabled=!0;const ke=()=>{g(N,w),g(F,B),g(U,S),g(j,k),J(M,I,"side-effect"),Object.values(A).map(e=>{const t=e.children[0].innerText,n=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":f(C,n,t);break;case"Move":f(x,n,t);break;case"Live":const c=E(n,t,"live");_.appendChild(c);break}})},we=async e=>{var t;e.preventDefault(),re();try{let n=!1;const o=n?Ee():H();o.isProfessional=n;let c="620f78370eeeb2cc10a23e94";o["webflow-id"]=c;const s=r.elements;let l="";if(((t=s.pic)==null?void 0:t.files)&&s.pic.files[0])try{const d=s.pic.files[0],T=await W(d);o.image=T}catch(d){l="Could not upload your image",console.log(l,d)}const y=await D(o);if(!y.ok)throw new Error("Network response was not OK");me("Success");const h=await y.json();window.location.replace(window.location.href+"/user/"+h.result.slug)}catch(n){de("Could not update your information",n)}finally{ie()}},Be=()=>{V(O,P.firstName)};a.api=le,a.cf=ue,a.collection=oe,a.createFieldsFromCollections=ke,a.gf=ve,a.mapUserFieldToBody=H,a.populateDefaults=Be,a.selector=ne,a.submitOnboardingForm=we,a.upload=be,Object.defineProperty(a,"__esModule",{value:!0}),a[Symbol.toStringTag]="Module"});
