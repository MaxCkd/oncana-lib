(function(s,r){typeof exports=="object"&&typeof module!="undefined"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(s=typeof globalThis!="undefined"?globalThis:s||self,r(s.oncana={}))})(this,function(s){"use strict";const r=document.querySelector("#onboarding"),d=document.querySelector(".loader"),m=document.querySelector(".error-msg"),u=document.querySelector(".success-msg"),v=document.getElementById("select-cancer-type"),T=document.getElementById("select-cancer-stage"),S=document.getElementById("select-treatment-type"),w=document.getElementById("select-treatment-stage"),k=document.getElementById("select-eat"),E=document.getElementById("select-move"),C=document.getElementById("checkboxes-side-effect"),x=document.getElementById("checkboxes-live"),J=document.getElementById("image-input"),K=document.getElementById("image-preview");var W=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",form:r,loader:d,errorMsg:m,successMsg:u,cancerType:v,cancerStage:T,treatmentType:S,treatmentStage:w,eat:k,move:E,sideEffectWrapper:C,live:x,imageInput:J,imagePreview:K});const H=document.getElementsByClassName("cancer-type-item"),G=document.getElementsByClassName("cancer-stage-item"),Q=document.getElementsByClassName("treatment-type-item"),V=document.getElementsByClassName("treatment-stage-item"),X=document.getElementsByClassName("side-effect-item"),Y=document.getElementsByClassName("category-item"),f="http://127.0.0.1:3000/dev",Z=f+"/webflow",ee=f+"/get-presigned-url",te={"Content-Type":"application/json",Accept:"*"},B=(e,t)=>fetch(ee,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),O=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),b=e=>fetch(Z,{method:"PATCH",headers:te,body:JSON.stringify(e)});var ne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:f,getUploadUrl:B,uploadToS3:O,updateUser:b});const _=()=>{j(),M(),d.style.display="flex",d.innerText="Loading"},I=()=>{d.style.display="none",d.innerText=""},U=(e,t)=>{console.log(e,t),m.style.display="flex",m.innerText=e,setTimeout(()=>{j()},3e3)},j=()=>{m.style.display="none",m.innerText=""},F=e=>{u.style.display="flex",u.innerText=e,setTimeout(()=>{M()},3e3)},M=()=>{u.style.display="none",u.innerText=""},y=(e,t,n)=>{e&&t&&n&&e.options.add(new Option(n,t))},h=(e,t,n)=>{const o=document.createElement("label"),c=document.createElement("input");c.type="checkbox",c.name=e,c.setAttribute("data-type",n);const a=document.createElement("span");a.className="checkmark";const l=document.createElement("span");return l.className="checktext",l.innerText=t,o.appendChild(c),o.appendChild(a),o.appendChild(l),o},p=(e,t)=>{Object.values(e).map(n=>{const o=n.children[0].innerText,c=n.children[1].innerText;y(t,c,o)})},N=(e,t,n)=>{Object.values(e).map(o=>{const c=o.children[0].innerText,a=o.children[1].innerText,l=h(a,c,n);t.appendChild(l)})};var oe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:y,addCheckBox:h,mapCollectionSelector:p,mapCollectionCheckBox:N});const ce=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),L=async e=>{const[t,n]=await Promise.all([ce(e),B(e.name,e.type)]);if(!n.ok)throw new Error("Could not get url upload");const{uploadUrl:o}=await n.json(),c=await O(o,t);if(!c.ok)throw new Error("Could not upload the image");return c.url},se=(e,t)=>{e.addEventListener("change",n=>{t.src=URL.createObjectURL(n.target.files[0])}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var ae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:L,previewImage:se});const re=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),i=e=>e&&e[e.selectedIndex].value,le=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),g=(e,t)=>Array.from(e).filter(n=>n.checked&&(t?n.getAttribute("data-type")===t:1)).map(n=>n.name).filter(n=>n);var ie=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:re,uniSelect:i,multiCheckbox:le,multiCheckboxFromEl:g});const A=()=>{var o,c,a,l,P,q,z,$,R,D;const e=r.elements,t=r.querySelectorAll('input[type="checkbox"]');return{"first-name":((o=e["first-name"])==null?void 0:o.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",gender:i(e.gender.options)||"",dob:((a=e.dob)==null?void 0:a.value)||"",postcode:((l=e.postcode)==null?void 0:l.value)||"","cancer-type":i((P=e["cancer-type"])==null?void 0:P.options)||"","cancer-stage":i((q=e["cancer-stage"])==null?void 0:q.options)||"","treatment-type":i((z=e["treatment-type"])==null?void 0:z.options)||"","treatment-stage":i(($=e["treatment-stage"])==null?void 0:$.options)||"","side-effects":g(t,"side-effect"),eat:i((R=e.eat)==null?void 0:R.options)||"",move:i((D=e.move)==null?void 0:D.options)||"",live:g(t,"live")}},de=()=>{const e=r.elements,t=r.querySelectorAll('input[type="checkbox"]');return{"first-name":e["first-name"].value,"last-name":e["last-name"].value,dob:e.dob.value,gender:i(e.gender.options),"side-effects":g(t,"side-effect")}},me=()=>{p(Q,S),p(V,w),p(H,v),p(G,T),N(X,C,"side-effect"),Object.values(Y).map(e=>{const t=e.children[0].innerText,n=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":y(k,n,t);break;case"Move":y(E,n,t);break;case"Live":const c=h(n,t,"live");x.appendChild(c);break}})},ue=async e=>{e.preventDefault(),_();try{const t=A();let n="6229092f36ca830004d459b4";t["memberstack-id"]=n;const o=await b(t);if(!o.ok)throw new Error("Network response was not OK");F("Success");const c=await o.json();window.location.replace(window.location.href+"/user/"+c.result.slug)}catch(t){U("Could not update your information",t)}finally{I()}},pe=async e=>{var c;e.preventDefault(),_();const t=r.elements,n=de();let o="";if(((c=t.pic)==null?void 0:c.files)&&t.pic.files[0])try{const a=t.pic.files[0],l=await L(a);n.image=l}catch(a){o="Could not upload your image",console.log(o,a)}try{if(!(await b(n)).ok)throw new Error("Network response was not OK");F("Success")}catch(a){U("Could not update your information",a)}finally{I()}};s.api=ne,s.cf=oe,s.createFieldsFromCollections=me,s.gf=ie,s.mapUserFieldToBody=A,s.selector=W,s.submitOnboardingForm=ue,s.submitProfessionalForm=pe,s.upload=ae,Object.defineProperty(s,"__esModule",{value:!0}),s[Symbol.toStringTag]="Module"});
