(function(s,p){typeof exports=="object"&&typeof module!="undefined"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(s=typeof globalThis!="undefined"?globalThis:s||self,p(s.oncana={}))})(this,function(s){"use strict";const p=document.querySelector("#user-form"),T=document.querySelector("#pro-form"),g=document.querySelector(".loader"),f=document.querySelector(".error-msg"),b=document.querySelector(".success-msg"),B=document.getElementById("select-cancer-type"),I=document.getElementById("select-cancer-stage"),j=document.getElementById("select-treatment-type"),_=document.getElementById("select-treatment-stage"),F=document.getElementById("select-eat"),U=document.getElementById("select-move"),N=document.getElementById("select-job"),v=document.getElementById("checkboxes-side-effects"),O=document.getElementById("checkboxes-lives"),P=document.getElementById("checkboxes-lifestyles"),se=document.getElementById("checkboxes-categories"),ae=document.getElementById("image-input"),re=document.getElementById("image-preview"),le=document.getElementById("image-upload"),ie=document.getElementById("image-feedback"),me=document.getElementById("first-name"),de=document.getElementById("bio"),ue=document.getElementById("last-name"),pe=document.getElementById("phone"),ye=document.getElementById("job-title"),ge=document.getElementById("oncana-categories");var fe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",userForm:p,proForm:T,loader:g,errorMsg:f,successMsg:b,cancerType:B,cancerStage:I,treatmentType:j,treatmentStage:_,eat:F,move:U,job:N,sideEffectWrapper:v,liveWrapper:O,lifestyleWrapper:P,categoryWrapper:se,imageInput:ae,imagePreview:re,imageUpload:le,imageFeedback:ie,firstName:me,bio:de,lastName:ue,phone:pe,jobTitle:ye,oncanaCategories:ge});const A=document.getElementsByClassName("cancer-type-item"),M=document.getElementsByClassName("cancer-stage-item"),q=document.getElementsByClassName("treatment-type-item"),D=document.getElementsByClassName("treatment-stage-item"),C=document.getElementsByClassName("side-effect-item"),W=document.getElementsByClassName("category-item"),z=document.getElementsByClassName("lifestyle-item"),$=document.getElementsByClassName("job-item"),S=document.getElementsByClassName("collection-page-item"),be=()=>{var t,o,n,c,r,a,m,l,i,u;const e=Array.from(S[0].children);return{firstName:((t=e[0])==null?void 0:t.innerText)||"",lastName:((o=e[1])==null?void 0:o.innerText)||"",bio:((n=e[2])==null?void 0:n.innerText)||"",phone:((c=e[3])==null?void 0:c.innerText)||"",postCode:((r=e[4])==null?void 0:r.innerText)||"",street:((a=e[5])==null?void 0:a.innerText)||"",website:((m=e[6])==null?void 0:m.innerText)||"",itemId:((l=e[7])==null?void 0:l.innerText)||"","selected-lifestyles":((i=e[8])==null?void 0:i.innerText)||"","selected-categories":((u=e[9])==null?void 0:u.innerText)||""}},he=()=>{var t;return{firstName:((t=Array.from(S[0].children)[0])==null?void 0:t.innerText)||""}};var Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",cancerType:A,cancerStage:M,treatmentType:q,treatmentStage:D,sideEffect:C,category:W,lifestyle:z,job:$,cpItem:S,getCurrentPro:be,getCurrentUser:he});const w="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",we=w+"/webflow/user",Ee=w+"/webflow/pro",xe=w+"/get-presigned-url",L={"Content-Type":"application/json",Accept:"*"},J=(e,t)=>fetch(xe,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),H=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),K=e=>fetch(we,{method:"PATCH",headers:L,body:JSON.stringify(e)}),V=e=>fetch(Ee,{method:"PATCH",headers:L,body:JSON.stringify(e)});var ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:w,getUploadUrl:J,uploadToS3:H,updateUser:K,updatePro:V});const G=()=>{X(),Z(),g.style.display="flex",g.innerText="Loading"},Q=()=>{g.style.display="none",g.innerText=""},R=(e,t)=>{console.log(e,t),f.style.display="flex",f.innerText=e,setTimeout(()=>{X()},3e3)},X=()=>{f.style.display="none",f.innerText=""},Y=e=>{b.style.display="flex",b.innerText=e,setTimeout(()=>{Z()},3e3)},Z=()=>{b.style.display="none",b.innerText=""},E=(e,t,o)=>{e&&t&&o&&e.options.add(new Option(o,t))},k=(e,t,o)=>{const n=document.createElement("label"),c=document.createElement("input");c.type="checkbox",c.name=e,c.setAttribute("data-type",o);const r=document.createElement("span");r.className="checkmark";const a=document.createElement("span");return a.className="checktext",a.innerText=t,n.appendChild(c),n.appendChild(r),n.appendChild(a),n},y=(e,t)=>{Object.values(e).map(o=>{const n=o.children[0].innerText,c=o.children[1].innerText;E(t,c,n)})},x=(e,t,o)=>{Object.values(e).map(n=>{const c=n.children[0].innerText,r=n.children[1].innerText,a=k(r,c,o);t.appendChild(a)})},Ce=(e,t)=>{e.defaultValue=t,e.placeholder=t},Se=(e,t)=>{Array.from(e.getElementsByTagName("input")).forEach(n=>{t.includes(n.name)&&(n.checked=!0)})},ke=(e,t)=>{var n;const o=(n=e.options.namedItem(t))==null?void 0:n.index;o&&(e.options.selectedIndex=o)};var Be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:E,addCheckBox:k,mapCollectionSelector:y,mapCollectionCheckBox:x,setDefaultInput:Ce,setDefaultCheckboxes:Se,setDefaultOption:ke});const Ie=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),ee=async e=>{const[t,o]=await Promise.all([Ie(e),J(e.name,e.type)]);if(!o.ok)throw new Error("Could not get url upload");const{uploadUrl:n}=await o.json(),c=await H(n,t);if(!c.ok)throw new Error("Could not upload the image");return c.url};var je=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:ee});const _e=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),d=e=>e&&e[e.selectedIndex].value,Fe=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),h=(e,t)=>Array.from(e).filter(o=>o.checked&&(t?o.getAttribute("data-type")===t:1)).map(o=>o.name).filter(o=>o);var Ue=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:_e,uniSelect:d,multiCheckbox:Fe,multiCheckboxFromEl:h});const te=()=>{var n,c,r,a,m,l,i,u,ne,ce;const e=p.elements,t=p.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",gender:d(e.gender.options)||"",dob:((r=e.dob)==null?void 0:r.value)||"",postcode:((a=e.postcode)==null?void 0:a.value)||"","cancer-type":d((m=e["cancer-type"])==null?void 0:m.options)||"","cancer-stage":d((l=e["cancer-stage"])==null?void 0:l.options)||"","treatment-type":d((i=e["treatment-type"])==null?void 0:i.options)||"","treatment-stage":d((u=e["treatment-stage"])==null?void 0:u.options)||"","side-effects":h(t,"side-effect"),eat:d((ne=e.eat)==null?void 0:ne.options)||"",move:d((ce=e.move)==null?void 0:ce.options)||"",live:h(t,"live")}},oe=()=>{var n,c,r,a,m,l,i,u;const e=T.elements,t=T.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",bio:((r=e.bio)==null?void 0:r.value)||"",job:d((a=e.job)==null?void 0:a.options)||"","job-title":((m=e.job)==null?void 0:m.value)||"",address:((l=e.address)==null?void 0:l.value)||"",phone:((i=e.phone)==null?void 0:i.value)||"",website:((u=e.website)==null?void 0:u.value)||"","side-effects":h(t,"side-effect"),lifestyles:h(t,"lifestyle")}},Ne=()=>{x(z,P,"lifestyle"),console.log("Create"),x(C,v,"side-effect"),y($,N)},Oe=()=>{y(q,j),y(D,_),y(A,B),y(M,I),x(C,v,"side-effect"),Object.values(W).map(e=>{const t=e.children[0].innerText,o=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":E(F,o,t);break;case"Move":E(U,o,t);break;case"Live":const c=k(o,t,"live");O.appendChild(c);break}})},Pe=async e=>{e.preventDefault(),G();try{const t=te();let o="620f78370eeeb2cc10a23e94";t["webflow-id"]=o;const n=await K(t);if(!n.ok)throw new Error("Network response was not OK");Y("Success");const c=await n.json();window.location.replace(window.location.href+"/user/"+c.result.slug)}catch(t){R("Could not update your information",t)}finally{Q()}},Ae=async e=>{var t;e.preventDefault(),G();try{const o=oe();let n="6213eae0fae77e75cf3dc004";o["webflow-id"]=n;const c=T.elements;let r="";if(((t=c.picture)==null?void 0:t.files)&&c.picture.files[0])try{const l=c.picture.files[0],i=await ee(l);console.log("Image Url",i),o.image=i}catch(l){r="Could not upload your image",console.log(r,l)}const a=await V(o);if(!a.ok)throw new Error("Network response was not OK");Y("Success");const m=await a.json();window.location.replace(window.location.href+"/user/"+m.result.slug)}catch(o){R("Could not update your information",o)}finally{Q()}};s.api=ve,s.cf=Be,s.collection=Te,s.createProFormFields=Ne,s.createUserFormFields=Oe,s.gf=Ue,s.mapProFieldToBody=oe,s.mapUserFieldToBody=te,s.selector=fe,s.submitProForm=Ae,s.submitUserForm=Pe,s.upload=je,Object.defineProperty(s,"__esModule",{value:!0}),s[Symbol.toStringTag]="Module"});
