(function(a,p){typeof exports=="object"&&typeof module!="undefined"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(a=typeof globalThis!="undefined"?globalThis:a||self,p(a.oncana={}))})(this,function(a){"use strict";const p=document.querySelector("#user-form"),T=document.querySelector("#pro-form"),g=document.querySelector(".loader"),f=document.querySelector(".error-msg"),b=document.querySelector(".success-msg"),B=document.getElementById("select-cancer-type"),I=document.getElementById("select-cancer-stage"),j=document.getElementById("select-treatment-type"),U=document.getElementById("select-treatment-stage"),F=document.getElementById("select-eat"),_=document.getElementById("select-move"),O=document.getElementById("select-job"),x=document.getElementById("checkboxes-side-effects"),N=document.getElementById("checkboxes-lives"),P=document.getElementById("checkboxes-lifestyles"),ce=document.getElementById("checkboxes-categories"),ae=document.getElementById("image-input"),re=document.getElementById("image-preview"),le=document.getElementById("image-upload"),ie=document.getElementById("image-feedback"),de=document.getElementById("first-name"),me=document.getElementById("bio"),ue=document.getElementById("last-name"),pe=document.getElementById("phone"),ye=document.getElementById("job-title"),ge=document.getElementById("oncana-categories");var fe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",userForm:p,proForm:T,loader:g,errorMsg:f,successMsg:b,cancerType:B,cancerStage:I,treatmentType:j,treatmentStage:U,eat:F,move:_,job:O,sideEffectWrapper:x,liveWrapper:N,lifestyleWrapper:P,categoryWrapper:ce,imageInput:ae,imagePreview:re,imageUpload:le,imageFeedback:ie,firstName:de,bio:me,lastName:ue,phone:pe,jobTitle:ye,oncanaCategories:ge});const A=document.getElementsByClassName("cancer-type-item"),M=document.getElementsByClassName("cancer-stage-item"),L=document.getElementsByClassName("treatment-type-item"),q=document.getElementsByClassName("treatment-stage-item"),k=document.getElementsByClassName("side-effect-item"),z=document.getElementsByClassName("category-item"),D=document.getElementsByClassName("lifestyle-item"),W=document.getElementsByClassName("job-item"),C=document.getElementsByClassName("collection-page-item"),be=()=>{var t,o,n,s,c,r,d,l,i,u;const e=Array.from(C[0].children);return{firstName:((t=e[0])==null?void 0:t.innerText)||"",lastName:((o=e[1])==null?void 0:o.innerText)||"",bio:((n=e[2])==null?void 0:n.innerText)||"",phone:((s=e[3])==null?void 0:s.innerText)||"",postCode:((c=e[4])==null?void 0:c.innerText)||"",street:((r=e[5])==null?void 0:r.innerText)||"",website:((d=e[6])==null?void 0:d.innerText)||"",itemId:((l=e[7])==null?void 0:l.innerText)||"","selected-lifestyles":((i=e[8])==null?void 0:i.innerText)||"","selected-categories":((u=e[9])==null?void 0:u.innerText)||""}},he=()=>{var t;return{firstName:((t=Array.from(C[0].children)[0])==null?void 0:t.innerText)||""}};var Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",cancerType:A,cancerStage:M,treatmentType:L,treatmentStage:q,sideEffect:k,category:z,lifestyle:D,job:W,cpItem:C,getCurrentPro:be,getCurrentUser:he});const w="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",we=w+"/webflow/user",Ee=w+"/webflow/pro",ve=w+"/get-presigned-url",$={"Content-Type":"application/json",Accept:"*"},R=(e,t)=>fetch(ve,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),J=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),H=e=>fetch(we,{method:"PATCH",headers:$,body:JSON.stringify(e)}),K=e=>fetch(Ee,{method:"PATCH",headers:$,body:JSON.stringify(e)});var xe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:w,getUploadUrl:R,uploadToS3:J,updateUser:H,updatePro:K});const V=()=>{X(),Z(),g.style.display="flex",g.innerText="Loading"},G=()=>{g.style.display="none",g.innerText=""},Q=(e,t)=>{console.log(e,t),f.style.display="flex",f.innerText=e,setTimeout(()=>{X()},3e3)},X=()=>{f.style.display="none",f.innerText=""},Y=e=>{b.style.display="flex",b.innerText=e,setTimeout(()=>{Z()},3e3)},Z=()=>{b.style.display="none",b.innerText=""},E=(e,t,o)=>{e&&t&&o&&e.options.add(new Option(o,t))},S=(e,t,o)=>{const n=document.createElement("label"),s=document.createElement("input");s.type="checkbox",s.name=e,s.setAttribute("data-type",o);const c=document.createElement("span");c.className="checkmark";const r=document.createElement("span");return r.className="checktext",r.innerText=t,n.appendChild(s),n.appendChild(c),n.appendChild(r),n},y=(e,t)=>{Object.values(e).map(o=>{const n=o.children[0].innerText,s=o.children[1].innerText;E(t,s,n)})},v=(e,t,o)=>{Object.values(e).map(n=>{const s=n.children[0].innerText,c=n.children[1].innerText,r=S(c,s,o);t.appendChild(r)})},ke=(e,t)=>{e.defaultValue=t,e.placeholder=t},Ce=(e,t)=>{Array.from(e.getElementsByTagName("input")).forEach(n=>{t.includes(n.name)&&(n.checked=!0)})},Se=(e,t)=>{var n;const o=(n=e.options.namedItem(t))==null?void 0:n.index;o&&(e.options.selectedIndex=o)};var Be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:E,addCheckBox:S,mapCollectionSelector:y,mapCollectionCheckBox:v,setDefaultInput:ke,setDefaultCheckboxes:Ce,setDefaultOption:Se});const Ie=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),ee=async e=>{const[t,o]=await Promise.all([Ie(e),R(e.name,e.type)]);if(!o.ok)throw new Error("Could not get url upload");const{uploadUrl:n}=await o.json(),s=await J(n,t);if(!s.ok)throw new Error("Could not upload the image");return s.url},je=["image/jpeg","image/png","image/jpg"],Ue=e=>je.includes(e.type)?e.size>5*10**6?"File is too big.":"ok":"File type is invalid",Fe=(e,t,o)=>{e.addEventListener("change",n=>{const s=n.target.files[0],c=Ue(s);c==="ok"?(console.log("File",n.target.files[0]),t.src=URL.createObjectURL(n.target.files[0])):o.innerText=c}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var _e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:ee,previewImage:Fe});const Oe=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),m=e=>e&&e[e.selectedIndex].value,Ne=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),h=(e,t)=>Array.from(e).filter(o=>o.checked&&(t?o.getAttribute("data-type")===t:1)).map(o=>o.name).filter(o=>o);var Pe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:Oe,uniSelect:m,multiCheckbox:Ne,multiCheckboxFromEl:h});const te=()=>{var n,s,c,r,d,l,i,u,ne,se;const e=p.elements,t=p.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((s=e["last-name"])==null?void 0:s.value)||"",gender:m(e.gender.options)||"",dob:((c=e.dob)==null?void 0:c.value)||"",postcode:((r=e.postcode)==null?void 0:r.value)||"","cancer-type":m((d=e["cancer-type"])==null?void 0:d.options)||"","cancer-stage":m((l=e["cancer-stage"])==null?void 0:l.options)||"","treatment-type":m((i=e["treatment-type"])==null?void 0:i.options)||"","treatment-stage":m((u=e["treatment-stage"])==null?void 0:u.options)||"","side-effects":h(t,"side-effect"),eat:m((ne=e.eat)==null?void 0:ne.options)||"",move:m((se=e.move)==null?void 0:se.options)||"",live:h(t,"live")}},oe=()=>{var n,s,c,r,d,l,i,u;const e=T.elements,t=T.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((s=e["last-name"])==null?void 0:s.value)||"",bio:((c=e.bio)==null?void 0:c.value)||"",job:m((r=e.job)==null?void 0:r.options)||"","job-title":((d=e.job)==null?void 0:d.value)||"",address:((l=e.address)==null?void 0:l.value)||"",phone:((i=e.phone)==null?void 0:i.value)||"",website:((u=e.website)==null?void 0:u.value)||"","side-effects":h(t,"side-effect"),lifestyles:h(t,"lifestyle")}},Ae=()=>{v(D,P,"lifestyle"),console.log("Create"),v(k,x,"side-effect"),y(W,O)},Me=()=>{y(L,j),y(q,U),y(A,B),y(M,I),v(k,x,"side-effect"),Object.values(z).map(e=>{const t=e.children[0].innerText,o=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":E(F,o,t);break;case"Move":E(_,o,t);break;case"Live":const s=S(o,t,"live");N.appendChild(s);break}})},Le=async e=>{e.preventDefault(),V();try{const t=te();let o="620f78370eeeb2cc10a23e94";t["webflow-id"]=o;const n=await H(t);if(!n.ok)throw new Error("Network response was not OK");Y("Success");const s=await n.json();window.location.replace(window.location.href+"/user/"+s.result.slug)}catch(t){Q("Could not update your information",t)}finally{G()}},qe=async e=>{var t;e.preventDefault(),V();try{const o=oe();let n="6213eae0fae77e75cf3dc004";o["webflow-id"]=n;const s=T.elements;let c="";if(((t=s.picture)==null?void 0:t.files)&&s.picture.files[0])try{const l=s.picture.files[0],i=await ee(l);console.log("Image Url",i),o.image=i}catch(l){c="Could not upload your image",console.log(c,l)}const r=await K(o);if(!r.ok)throw new Error("Network response was not OK");Y("Success");const d=await r.json();window.location.replace(window.location.href+"/user/"+d.result.slug)}catch(o){Q("Could not update your information",o)}finally{G()}};a.api=xe,a.cf=Be,a.collection=Te,a.createProFormFields=Ae,a.createUserFormFields=Me,a.gf=Pe,a.mapProFieldToBody=oe,a.mapUserFieldToBody=te,a.selector=fe,a.submitProForm=qe,a.submitUserForm=Le,a.upload=_e,Object.defineProperty(a,"__esModule",{value:!0}),a[Symbol.toStringTag]="Module"});
