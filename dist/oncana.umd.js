(function(a,r){typeof exports=="object"&&typeof module!="undefined"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(a=typeof globalThis!="undefined"?globalThis:a||self,r(a.oncana={}))})(this,function(a){"use strict";const r=document.querySelector("#onboarding"),d=document.querySelector(".loader"),m=document.querySelector(".error-msg"),u=document.querySelector(".success-msg"),v=document.getElementById("select-cancer-type"),w=document.getElementById("select-cancer-stage"),T=document.getElementById("select-treatment-type"),S=document.getElementById("select-treatment-stage"),k=document.getElementById("select-eat"),E=document.getElementById("select-move"),C=document.getElementById("checkboxes-side-effect"),x=document.getElementById("checkboxes-live"),J=document.getElementById("image-input"),K=document.getElementById("image-preview");var W=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",form:r,loader:d,errorMsg:m,successMsg:u,cancerType:v,cancerStage:w,treatmentType:T,treatmentStage:S,eat:k,move:E,sideEffectWrapper:C,live:x,imageInput:J,imagePreview:K});const H=document.getElementsByClassName("cancer-type-item"),G=document.getElementsByClassName("cancer-stage-item"),Q=document.getElementsByClassName("treatment-type-item"),V=document.getElementsByClassName("treatment-stage-item"),X=document.getElementsByClassName("side-effect-item"),Y=document.getElementsByClassName("category-item"),f="https://kj2a61qk36.execute-api.ap-southeast-2.amazonaws.com/dev",Z=f+"/webflow",ee=f+"/get-presigned-url",te={"Content-Type":"application/json",Accept:"*"},B=(e,t)=>fetch(ee,{method:"POST",body:JSON.stringify({filename:e,filetype:t})}),O=(e,t)=>fetch(e,{method:"PUT",headers:{Accept:"*","Content-Type":"image/png"},body:t}),b=e=>fetch(Z,{method:"PATCH",headers:te,body:JSON.stringify(e)});var oe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",api:f,getUploadUrl:B,uploadToS3:O,updateUser:b});const _=()=>{j(),M(),d.style.display="flex",d.innerText="Loading"},I=()=>{d.style.display="none",d.innerText=""},U=(e,t)=>{console.log(e,t),m.style.display="flex",m.innerText=e,setTimeout(()=>{j()},3e3)},j=()=>{m.style.display="none",m.innerText=""},F=e=>{u.style.display="flex",u.innerText=e,setTimeout(()=>{M()},3e3)},M=()=>{u.style.display="none",u.innerText=""},y=(e,t,o)=>{e&&t&&o&&e.options.add(new Option(o,t))},h=(e,t,o)=>{const n=document.createElement("label"),c=document.createElement("input");c.type="checkbox",c.name=e,c.setAttribute("data-type",o);const s=document.createElement("span");s.className="checkmark";const l=document.createElement("span");return l.className="checktext",l.innerText=t,n.appendChild(c),n.appendChild(s),n.appendChild(l),n},p=(e,t)=>{Object.values(e).map(o=>{const n=o.children[0].innerText,c=o.children[1].innerText;y(t,c,n)})},N=(e,t,o)=>{Object.values(e).map(n=>{const c=n.children[0].innerText,s=n.children[1].innerText,l=h(s,c,o);t.appendChild(l)})};var ne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",addOption:y,addCheckBox:h,mapCollectionSelector:p,mapCollectionCheckBox:N});const ce=async e=>new Blob([new Uint8Array(await e.arrayBuffer())],{type:e.type}),L=async e=>{const[t,o]=await Promise.all([ce(e),B(e.name,e.type)]);if(!o.ok)throw new Error("Could not get url upload");const{uploadUrl:n}=await o.json(),c=await O(n,t);if(!c.ok)throw new Error("Could not upload the image");return c.url},ae=(e,t)=>{e.addEventListener("change",o=>{t.src=URL.createObjectURL(o.target.files[0])}),t.addEventListener("load",()=>{URL.revokeObjectURL(t.src)})};var se=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uploadImage:L,previewImage:ae});const re=e=>e&&Object.values(e).map(t=>t.selected&&t.value).filter(t=>t),i=e=>e&&e[e.selectedIndex].value,le=e=>Object.values(e).map(t=>t.checked&&t.name).filter(t=>t),g=(e,t)=>Array.from(e).filter(o=>o.checked&&(t?o.getAttribute("data-type")===t:1)).map(o=>o.name).filter(o=>o);var ie=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",multiSelect:re,uniSelect:i,multiCheckbox:le,multiCheckboxFromEl:g});const A=()=>{var n,c,s,l,P,q,z,$,R,D;const e=r.elements,t=r.querySelectorAll('input[type="checkbox"]');return{"first-name":((n=e["first-name"])==null?void 0:n.value)||"","last-name":((c=e["last-name"])==null?void 0:c.value)||"",gender:i(e.gender.options)||"",dob:((s=e.dob)==null?void 0:s.value)||"",postcode:((l=e.postcode)==null?void 0:l.value)||"","cancer-type":i((P=e["cancer-type"])==null?void 0:P.options)||"","cancer-stage":i((q=e["cancer-stage"])==null?void 0:q.options)||"","treatment-type":i((z=e["treatment-type"])==null?void 0:z.options)||"","treatment-stage":i(($=e["treatment-stage"])==null?void 0:$.options)||"","side-effects":g(t,"side-effect"),eat:i((R=e.eat)==null?void 0:R.options)||"",move:i((D=e.move)==null?void 0:D.options)||"",live:g(t,"live")}},de=()=>{const e=r.elements,t=r.querySelectorAll('input[type="checkbox"]');return{"first-name":e["first-name"].value,"last-name":e["last-name"].value,dob:e.dob.value,gender:i(e.gender.options),"side-effects":g(t,"side-effect")}},me=()=>{p(Q,T),p(V,S),p(H,v),p(G,w),N(X,C,"side-effect"),Object.values(Y).map(e=>{const t=e.children[0].innerText,o=e.children[1].innerText;switch(e.children[2].innerText){case"Eat":y(k,o,t);break;case"Move":y(E,o,t);break;case"Live":const c=h(o,t,"live");x.appendChild(c);break}})},ue=async e=>{e.preventDefault(),_();try{const t=A();let o="620f78370eeeb2cc10a23e94";t["webflow-id"]=o;const n=await b(t);if(!n.ok)throw new Error("Network response was not OK");F("Success");const c=await n.json();window.location.replace(window.location.href+"/user/"+c.result.slug)}catch(t){U("Could not update your information",t)}finally{I()}},pe=async e=>{var c;e.preventDefault(),_();const t=r.elements,o=de();let n="";if(((c=t.pic)==null?void 0:c.files)&&t.pic.files[0])try{const s=t.pic.files[0],l=await L(s);o.image=l}catch(s){n="Could not upload your image",console.log(n,s)}try{if(!(await b(o)).ok)throw new Error("Network response was not OK");F("Success")}catch(s){U("Could not update your information",s)}finally{I()}};a.api=oe,a.cf=ne,a.createFieldsFromCollections=me,a.gf=ie,a.mapUserFieldToBody=A,a.selector=W,a.submitOnboardingForm=ue,a.submitProfessionalForm=pe,a.upload=se,Object.defineProperty(a,"__esModule",{value:!0}),a[Symbol.toStringTag]="Module"});
